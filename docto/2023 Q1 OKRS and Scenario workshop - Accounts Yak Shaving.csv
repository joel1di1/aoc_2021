,,,"account is a central table as it linked to hundreds of other tables,
yet, beside the relations, the pure content of the table could live in X other storage more relevant to capabilities,
we could think of this table being only append only information on creation and the source of truth
 id:bigint -> id, type, locale, created_at, deleted_at",,,,,
name,type,PG comment,analysis or comment if misssing,"move out from table
0 -> no
10 -> obvious we should",,Current Size,Resulting size,expected gain
,,,,,,18.84512001,8.334179851,0.5577539518
locale,character varying(10),,,0,,163811340,163811340,
type,character varying,features:MY DOCTOLIB - RIGHTS MANAGEMENT,,0,,435916553,435916553,
id,bigint,,,0,,436832248,436832248,
email,character varying(255),,"login key, 2FA
source for all email notification",5,,1281099744,1281099744,
created_at,timestamp without time zone,,,0,,436832248,436832248,
updated_at,timestamp without time zone,,,0,,436832248,436832248,
kind,character varying(255),,,0,,435848710,435848710,
phone_number,character varying(255),,"login key, 2FA
source for all SMS notification",5,,674630410,674630410,
verified_at,timestamp without time zone,,,0,,392849216,392849216,
deleted_at,timestamp without time zone,,,0,,30218664,30218664,
password_last_updated_at,timestamp without time zone,,use to force-logout all sessions when changed,8,,140631824,140631824,
cloudinary_public_id,character varying(255),,,8,,86050,86050,
ref,character varying(255),,marketing stats for patient account i guess,8,,18960691,18960691,
secretaryship_group_id,bigint,,specific to secretaryship users,8,,119296,119296,
locked_at,timestamp without time zone,,"prevent logging-in, not sure if it force logs-out when set, i hope so",8,,118872,118872,
external_id,character varying,,"AP-HP only feature to sync with their systems. I don't remember 100% the use case, it is around online booking for HCP profiles to matching with APHP website",8,,109010,109010,
email_verified_at,timestamp without time zone,,,8,,336722376,336722376,
password_digest,character varying(255),,still in double run but should be deprecated ,9,,3112560351,3112560351,
first_name,character varying(255),,"from security perspective, I would recommend this table not to have PHI",10,,409215523,0,
last_name,character varying(255),,"from security perspective, I would recommend this table not to have PHI",10,,425453354,0,
email_security_token,character varying(255),,"reset password feature, may already be deprecated",10,,115866855,0,
email_security_token_generated_at,timestamp without time zone,,,10,,46724144,0,
handled_by_support,boolean,,,10,,54604031,0,
temporary_password,character varying(255),,,10,,5700574,0,
job,character varying(255),,,10,,11965113,0,
gender,boolean,,,10,,45794530,0,
birthdate,date,,,10,,186149628,0,
agenda_preferences,hstore,,"only for doctors, for calendar usage at first. big crap inside, the feature switch at account level is hidden there, other product use it also",10,,1141984209,0,
trainee_ids,character varying(255)[],,"deprecated, was used for sales team before salesforce was in place",10,,709854090,0,
email_connection_deactivated_at,timestamp without time zone,,used in batch notification when user connects on a new device,10,,80,0,
restricted_secretaryship_group_ids,bigint[],,specific to secretaryship users,10,,710002889,0,
staff_configuration_id,bigint,,long running deprecated configuration management replaced by pundit policies and security table authorizations,10,,47432,0,
otp_secret_key,character varying,,used only during 2FA validation,10,,345188397,0,
disable_anonymization_until,timestamp without time zone,,for support usage only,10,,8264,0,
previous_phone_number,character varying,,temporary storage when user is updating his phone number,10,,1068864,0,
password_security,integer,,deprecated,10,,200377152,0,
hide_phone_number_from_staff,boolean,,deprecated,10,,20312,0,
follow_up_sent_at,timestamp without time zone,,batch related,10,,70280,0,
external_identifiers,hstore,The account identifiers on external platforms (example: intercom),,10,,4771318379,0,
pin_digest,character varying,,,10,,31862923,0,
first_connection,timestamp without time zone,,,10,,4807088,0,
stripe_metadata,jsonb,,only for patient account when doing TCS,10,,1015904680,0,
salesforce_account_id,character varying,features:MY DOCTOLIB|PRODUCT OWNER / SALESFORCE|ACCOUNTS MATCHER,same usecase as external_identifiers,10,,4839053,0,
contact_info_confirmed_at,timestamp without time zone,,,10,,266131408,0,
deanonymization_allowed_until,timestamp without time zone,,sounds duplicate of disable_anonymization_until,10,,12696,0,
lifelong_doctor_number,character varying,,,10,,50,0,
marketing_opt_in_shown_at,timestamp without time zone,,deprecated - WIP,10,,5968160,0,
